<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" rel="stylesheet">
    <title>Archery Academy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <nav aria-label="Main navigation">
        <button class="nav-toggle" aria-label="Open navigation" aria-controls="nav-links" aria-expanded="false">
            <span class="hamburger"></span>
        </button>
        <img class="nav-logo" src="images/archeryacademy-logo-white.png" alt="Straight to the point Archery logo">
        <div class="nav-links-wrapper" id="nav-links">
            <div class="nav-links">
                <div class="nav-link-item"><a href="index.html">Home</a></div>
                <div class="nav-link-item"><a href="about.html">About Us</a></div>
                <div class="nav-link-item"><a href="classes.html">Classes</a></div>
                <div class="nav-link-item"><a href="private-lessons.html">Private Lessons</a></div>
                <div class="nav-link-item"><a href="instructors.html">Instructors</a></div>
                <div class="nav-link-item"><a href="contact.html">Contact Us</a></div>
            </div>
        </div>
    </nav>
    <header class="header-other">   
        <section class="hero-section">
            <h1>Hit Your First Bullseye</h1>
            <p class="header-text">Aim Higher. Hit Your Mark. Archery for Everyone.</p>
        </section> 
    </header>
    <main id="main-content">
        <section class="contact-section">
            <h2>Contact Us</h2>
            <p class="intro-text">Use the form below to get general information, request private lessons, or register for a class.</p>
            <form id="contact-form" class="contact-form" action="/api/contact" method="post" novalidate>
                <p id="form-status" class="visually-hidden" role="status" aria-live="polite"></p>

                <label for="purpose">I am contacting about</label>
                <select id="purpose" name="purpose" aria-controls="private-fields register-fields" required>
                    <option value="general">General Information</option>
                    <option value="private">Private Lessons</option>
                    <option value="register">Register for a Class</option>
                </select>

                <label for="name">Full name</label>
                <input id="name" name="name" type="text" required aria-required="true">

                <label for="email">Email</label>
                <input id="email" name="email" type="email" required aria-required="true">

                <label for="phone">Phone (optional)</label>
                <input id="phone" name="phone" type="tel">

                <div id="private-fields" class="conditional-fields" style="display:none;" aria-hidden="true">
                    <label for="instructor">Preferred Instructor (optional)</label>
                    <input id="instructor" name="instructor" type="text">
                    <label for="lesson-date">Preferred Date (optional)</label>
                    <input id="lesson-date" name="lesson-date" type="date">
                </div>

                <div id="register-fields" class="conditional-fields" style="display:none;" aria-hidden="true">
                    <label for="class-select">Class</label>
                    <select id="class-select" name="class-select">
                        <option value="A101">A101 Basic Archery</option>
                        <option value="A102">A102 Intermediate</option>
                        <option value="A103">A103 Advanced</option>
                    </select>
                    <label for="participants">Number of Participants</label>
                    <input id="participants" name="participants" type="number" min="1" value="1">
                </div>

                <label for="message">Message</label>
                <textarea id="message" name="message" rows="5" required aria-required="true"></textarea>

                <button type="submit" class="btn" id="submit-btn">Send Message</button>
            </form>
        </section>
    </main>
    <footer>
       <div class="footer-links">
            <a href="index.html">Home</a> |
            <a href="about.html">About Us</a> |
            <a href="classes.html">Classes</a> |
            <a href="private-lessons.html">Private Lessons</a> |
            <a href="instructors.html">Instructors</a> |
            <a href="contact.html">Contact Us</a>
        </div>
        <br>
                <img src="images/archeryacademy-logo-white.png" class="footer-logo" alt="Straight to the point Archery logo">
        <div class="footer-text">
            <p>&copy; 2025 Straight to the Point Archery Academy</p>
            <p>All rights reserved.</p>
        </div>
    </footer>
<script>
document.querySelector('.nav-toggle').addEventListener('click', function() {
    var navLinks = document.getElementById('nav-links');
    var expanded = this.getAttribute('aria-expanded') === 'true';
    this.setAttribute('aria-expanded', !expanded);
    navLinks.classList.toggle('open');
});
</script>
<script>
// Contact form: dynamic fields, ARIA updates, and server POST
(function(){
    var purpose = document.getElementById('purpose');
    var privateFields = document.getElementById('private-fields');
    var registerFields = document.getElementById('register-fields');
    var form = document.getElementById('contact-form');
    var status = document.getElementById('form-status');
    var submitBtn = document.getElementById('submit-btn');

    function updateFields(){
        var v = purpose.value;
        var showPrivate = (v === 'private');
        var showRegister = (v === 'register');
        privateFields.style.display = showPrivate ? 'block' : 'none';
        privateFields.setAttribute('aria-hidden', !showPrivate);
        registerFields.style.display = showRegister ? 'block' : 'none';
        registerFields.setAttribute('aria-hidden', !showRegister);
    }
    purpose.addEventListener('change', updateFields);
    updateFields();

    function setStatus(message, isError){
        status.textContent = message;
        status.className = isError ? 'status-error' : 'status-success';
        status.classList.remove('visually-hidden');
        if (!isError) {
            // move focus to the status message for screen readers
            status.focus();
        }
    }

    form.addEventListener('submit', function(e){
        e.preventDefault();
        submitBtn.disabled = true;
        setStatus('Sending messageâ€¦', false);

        var formData = new FormData(form);
        var payload = {};
        formData.forEach(function(value, key){ payload[key] = value; });

        fetch(form.action, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        }).then(function(resp){
            if (!resp.ok) throw new Error('Network response was not ok');
            return resp.json();
        }).then(function(data){
            if (data && data.success) {
                setStatus('Thanks! Your message was sent.', false);
                form.reset();
                updateFields();
            } else {
                throw new Error((data && data.error) || 'Server error');
            }
        }).catch(function(err){
            // If there's no server (testing locally), simulate success so QA can test the UI.
            console.warn('Submission failed, entering test-mode simulation:', err);
            console.log('Simulated payload:', payload);
            setStatus('Test mode: message simulated (no server). Check console for payload.', false);
            form.reset();
            updateFields();
        }).finally(function(){
            submitBtn.disabled = false;
        });
    });
})();
</script>
</body>
</html>